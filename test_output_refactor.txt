[info] welcome to sbt 1.10.3 (Homebrew Java 17.0.13)
[info] loading settings for project gemini4s-build-build-build from metals.sbt ...
[info] loading project definition from /Users/jamesmiller/git/gemini4s/project/project/project
[info] loading settings for project gemini4s-build-build from metals.sbt ...
[info] loading project definition from /Users/jamesmiller/git/gemini4s/project/project
[success] Generated .bloop/gemini4s-build-build.json
[success] Total time: 1 s, completed 2 Dec 2025, 09:45:52
[info] loading settings for project gemini4s-build from metals.sbt,plugins.sbt ...
[info] loading project definition from /Users/jamesmiller/git/gemini4s/project
[success] Generated .bloop/gemini4s-build.json
[success] Total time: 1 s, completed 2 Dec 2025, 09:45:53
[info] loading settings for project root from build.sbt,docs.sbt ...
[info] set scmInfo to https://github.com/JamesMMiller/gemini4s
[info] set current project to gemini4s (in build file:/Users/jamesmiller/git/gemini4s/)
[32mgemini4s.model.GeminiServiceEnumSpec:[0m
[32m  + [0m[32mTaskType should decode valid values[0m [90m0.086s[0m
[32m  + [0m[32mTaskType should fail on invalid values[0m [90m0.002s[0m
[32m  + [0m[32mHarmCategory should decode valid values[0m [90m0.001s[0m
[32m  + [0m[32mHarmCategory should fail on invalid values[0m [90m0.001s[0m
[32m  + [0m[32mHarmBlockThreshold should decode valid values[0m [90m0.001s[0m
[32m  + [0m[32mHarmBlockThreshold should fail on invalid values[0m [90m0.001s[0m
[32m  + [0m[32mFunctionCallingMode should decode valid values[0m [90m0.001s[0m
[32m  + [0m[32mFunctionCallingMode should fail on invalid values[0m [90m0.0s[0m
[32m  + [0m[32mSchemaType should decode valid values[0m [90m0.001s[0m
[32m  + [0m[32mSchemaType should fail on invalid values[0m [90m0.0s[0m
[32mgemini4s.http.GeminiHttpClientSpec:[0m
[32m  + [0m[32mpost should handle successful response[0m [90m0.105s[0m
[32m  + [0m[32mpost should handle API errors[0m [90m0.003s[0m
[32m  + [0m[32mpost should handle network errors[0m [90m0.002s[0m
[32m  + [0m[32mpost should handle connection exceptions[0m [90m0.012s[0m
[32m  + [0m[32mpostStream should handle successful streaming response[0m [90m0.065s[0m
[32m  + [0m[32mpostStream should handle stream errors[0m [90m0.005s[0m
[32mgemini4s.model.domain.ContentSpec:[0m
[32m  + [0m[32mContent should create with role[0m [90m0.0s[0m
[32m  + [0m[32mContent should create without role[0m [90m0.0s[0m
[32m  + [0m[32mContent should handle multiple parts[0m [90m0.0s[0m
[32m  + [0m[32mContent should handle empty parts list[0m [90m0.001s[0m
[32mgemini4s.model.response.CountTokensResponseSpec:[0m
[32m  + [0m[32mCountTokensResponse should decode with only totalTokens[0m [90m0.004s[0m
[32m  + [0m[32mCountTokensResponse should handle optional candidatesTokenCount[0m [90m0.0s[0m
[32m  + [0m[32mCountTokensResponse should handle optional cachedContentTokenCount[0m [90m0.0s[0m
[32m  + [0m[32mCountTokensResponse should handle all fields[0m [90m0.001s[0m
[32m  + [0m[32mCountTokensResponse should handle missing optional fields gracefully[0m [90m0.0s[0m
[32mgemini4s.MultimodalSpec:[0m
[32m  + [0m[32mContentPart.InlineData should encode correctly[0m [90m0.005s[0m
[32m  + [0m[32mContentPart.FileData should encode correctly[0m [90m0.001s[0m
[32m  + [0m[32mGeminiService.image helper should create InlineData[0m [90m0.001s[0m
[32m  + [0m[32mGeminiService.file helper should create FileData[0m [90m0.0s[0m
[32m  + [0m[32mMimeType codec[0m [90m0.0s[0m
[32m  + [0m[32mBase64Data codec should work[0m [90m0.0s[0m
[32m  + [0m[32mFileUri codec should work[0m [90m0.0s[0m
[32m  + [0m[32mGeminiService.image helper should create correct ContentPart[0m [90m0.0s[0m
[32m  + [0m[32mGeminiService.file helper should create correct ContentPart[0m [90m0.0s[0m
[32mgemini4s.GeminiConstantsSpec:[0m
[91m==> X [0m[91mgemini4s.GeminiConstantsSpec[0m.[91mDefaultModel should be models/gemini-2.5-flash[0m  [90m0.011s[0m munit.ComparisonFailException: /Users/jamesmiller/git/gemini4s/src/test/scala/gemini4s/GeminiConstantsSpec.scala:15
14:  test("DefaultModel should be models/gemini-2.5-flash") {
[7m15:    assertEquals(GeminiConstants.DefaultModel.value, "models/gemini-2.5-flash")[0m
16:  }
values are not the same
[1m=> Obtained[0m
gemini-flash-latest
[1m=> Diff[0m ([91m- obtained[0m, [92m+ expected[0m)
[91m-gemini-flash-latest[0m
[92m+models/gemini-2.5-flash[0m
[90m    at [0m[90mmunit.FunSuite.assertEquals[0m[90m([0m[90mFunSuite.scala[0m:[90m11[0m[90m)[0m
[1m    at [0m[1mgemini4s.GeminiConstantsSpec.$init$$$anonfun$1[0m[1m([0m[1mGeminiConstantsSpec.scala[0m:[1m15[0m[1m)[0m
[32m  + [0m[32mMaxTokensPerRequest should be 30720[0m [90m0.0s[0m
[32m  + [0m[32mDefaultGenerationConfig should have correct values[0m [90m0.001s[0m
[32m  + [0m[32mtext helper should create Content.Text correctly[0m [90m0.0s[0m
[32m  + [0m[32mEndpoints should generate correct paths[0m [90m0.001s[0m
[91m==> X [0m[91mgemini4s.GeminiConstantsSpec[0m.[91mEndpoints should handle custom model names[0m  [90m0.0s[0m munit.ComparisonFailException: /Users/jamesmiller/git/gemini4s/src/test/scala/gemini4s/GeminiConstantsSpec.scala:50
49:    val customModel = ModelName.unsafe("models/custom-model")
[7m50:    assertEquals(GeminiConstants.Endpoints.generateContent(customModel), "models/custom-model:generateContent")[0m
51:    assertEquals(
values are not the same
[1m=> Obtained[0m
models/models/custom-model:generateContent
[1m=> Diff[0m ([91m- obtained[0m, [92m+ expected[0m)
[91m-models/models/custom-model:generateContent[0m
[92m+models/custom-model:generateContent[0m
[90m    at [0m[90mmunit.FunSuite.assertEquals[0m[90m([0m[90mFunSuite.scala[0m:[90m11[0m[90m)[0m
[1m    at [0m[1mgemini4s.GeminiConstantsSpec.$init$$$anonfun$6[0m[1m([0m[1mGeminiConstantsSpec.scala[0m:[1m50[0m[1m)[0m
[91m==> X [0m[91mgemini4s.GeminiConstantsSpec[0m.[91mEndpoints should handle tuned model names[0m  [90m0.0s[0m munit.ComparisonFailException: /Users/jamesmiller/git/gemini4s/src/test/scala/gemini4s/GeminiConstantsSpec.scala:65
64:    val tunedModel = ModelName.unsafe("tunedModels/my-tuned-model")
[7m65:    assertEquals(GeminiConstants.Endpoints.generateContent(tunedModel), "tunedModels/my-tuned-model:generateContent")[0m
66:  }
values are not the same
[1m=> Obtained[0m
models/tunedModels/my-tuned-model:generateContent
[1m=> Diff[0m ([91m- obtained[0m, [92m+ expected[0m)
[91m-models/tunedModels/my-tuned-model:generateContent[0m
[92m+tunedModels/my-tuned-model:generateContent[0m
[90m    at [0m[90mmunit.FunSuite.assertEquals[0m[90m([0m[90mFunSuite.scala[0m:[90m11[0m[90m)[0m
[1m    at [0m[1mgemini4s.GeminiConstantsSpec.$init$$$anonfun$7[0m[1m([0m[1mGeminiConstantsSpec.scala[0m:[1m65[0m[1m)[0m
[32mgemini4s.error.GeminiErrorSpec:[0m
[32m  + [0m[32mprovide correct error messages[0m [90m0.0s[0m
[32m  + [0m[32mhandle causes correctly[0m [90m0.001s[0m
[32m  + [0m[32mhandle null causes correctly[0m [90m0.0s[0m
[32m  + [0m[32mcreate errors with smart constructors[0m [90m0.001s[0m
[32m  + [0m[32mcreate errors with custom messages[0m [90m0.0s[0m
[32m  + [0m[32mcreate network errors correctly[0m [90m0.001s[0m
[32m  + [0m[32mcreate stream errors correctly[0m [90m0.001s[0m
[32m  + [0m[32mmap throwables to GeminiErrors[0m [90m0.001s[0m
[32m  + [0m[32mmap status codes to appropriate errors[0m [90m0.001s[0m
[32mgemini4s.model.domain.SafetySettingSpec:[0m
[32m  + [0m[32mSafetySetting should create with category and threshold[0m [90m0.001s[0m
[32m  + [0m[32mSafetySetting should handle all harm categories[0m [90m0.0s[0m
[32m  + [0m[32mSafetySetting should handle all thresholds[0m [90m0.0s[0m
[32mgemini4s.model.GeminiServiceCodecSpec:[0m
[32m  + [0m[32mGenerateContentRequest codec[0m [90m0.011s[0m
[32m  + [0m[32mCountTokensRequest codec[0m [90m0.001s[0m
[32m  + [0m[32mEmbedContentRequest codec[0m [90m0.002s[0m
[32m  + [0m[32mBatchEmbedContentsRequest codec[0m [90m0.001s[0m
[32m  + [0m[32mCreateCachedContentRequest codec[0m [90m0.001s[0m
[32m  + [0m[32mGenerateContentResponse codec[0m [90m0.001s[0m
[32m  + [0m[32mCountTokensResponse codec[0m [90m0.001s[0m
[32m  + [0m[32mEmbedContentResponse codec[0m [90m0.001s[0m
[32m  + [0m[32mBatchEmbedContentsResponse codec[0m [90m0.001s[0m
[32m  + [0m[32mCachedContent codec[0m [90m0.001s[0m
[32m  + [0m[32mSchema codec[0m [90m0.003s[0m
[32m  + [0m[32mFunctionCallData codec[0m [90m0.001s[0m
[32m  + [0m[32mExecutableCodeData codec[0m [90m0.001s[0m
[32m  + [0m[32mCodeExecutionResultData codec[0m [90m0.001s[0m
[32m  + [0m[32mContentPart codec[0m [90m0.001s[0m
[32m  + [0m[32mSafetySetting codec[0m [90m0.0s[0m
[32m  + [0m[32mGenerationConfig codec[0m [90m0.0s[0m
[32mgemini4s.model.response.GenerateContentResponseSpec:[0m
[32m  + [0m[32mGenerateContentResponse should decode with optional fields[0m [90m0.001s[0m
[32m  + [0m[32mGenerateContentResponse should handle usageMetadata[0m [90m0.0s[0m
[32m  + [0m[32mGenerateContentResponse should handle modelVersion[0m [90m0.0s[0m
[32m  + [0m[32mGenerateContentResponse should handle promptFeedback[0m [90m0.0s[0m
[32m  + [0m[32mCandidate should handle all fields[0m [90m0.0s[0m
[32m  + [0m[32mResponsePart.Text should encode/decode[0m [90m0.0s[0m
[32m  + [0m[32mResponsePart.FunctionCall should encode/decode[0m [90m0.0s[0m
[32m  + [0m[32mUsageMetadata should handle optional fields[0m [90m0.001s[0m
[32m  + [0m[32mUsageMetadata should handle missing optional fields[0m [90m0.0s[0m
[32mgemini4s.model.GeminiServiceFeaturesSpec:[0m
[32m  + [0m[32mEmbedContentRequest should encode correctly[0m [90m0.001s[0m
[32m  + [0m[32mBatchEmbedContentsRequest should encode correctly[0m [90m0.0s[0m
[32m  + [0m[32mEmbedContentResponse should decode correctly[0m [90m0.001s[0m
[32m  + [0m[32mBatchEmbedContentsResponse should decode correctly[0m [90m0.001s[0m
[32m  + [0m[32mCreateCachedContentRequest should encode correctly[0m [90m0.0s[0m
[32m  + [0m[32mCachedContent response should decode correctly[0m [90m0.001s[0m
[32mgemini4s.model.domain.ToolSpec:[0m
[32m  + [0m[32mTool should create with function declarations[0m [90m0.0s[0m
[32m  + [0m[32mTool should create without function declarations[0m [90m0.0s[0m
[32m  + [0m[32mTool should encode to JSON[0m [90m0.001s[0m
[32m  + [0m[32mFunctionDeclaration should create with parameters[0m [90m0.0s[0m
[32m  + [0m[32mFunctionDeclaration should create without parameters[0m [90m0.0s[0m
[32m  + [0m[32mToolConfig should create with function calling config[0m [90m0.0s[0m
[32m  + [0m[32mToolConfig should create without function calling config[0m [90m0.0s[0m
[32m  + [0m[32mFunctionCallingConfig should handle mode[0m [90m0.001s[0m
[32m  + [0m[32mFunctionCallingConfig should handle allowed function names[0m [90m0.0s[0m
[32mgemini4s.model.domain.GenerationConfigSpec:[0m
[32m  + [0m[32mGenerationConfig should encode with all fields[0m [90m0.0s[0m
[32m  + [0m[32mGenerationConfig should encode with minimal fields[0m [90m0.0s[0m
[32m  + [0m[32mGenerationConfig should decode from JSON[0m [90m0.004s[0m
[32m  + [0m[32mGenerationConfig should handle empty config[0m [90m0.0s[0m
[32m  + [0m[32mGenerationConfig should handle responseMimeType[0m [90m0.001s[0m
[32m  + [0m[32mGenerationConfig should handle stopSequences[0m [90m0.0s[0m
[32mgemini4s.model.domain.OpaqueTypesSpec:[0m
[32m  + [0m[32mApiKey validation[0m [90m0.001s[0m
[32m  + [0m[32mTemperature validation[0m [90m0.0s[0m
[32m  + [0m[32mTopK validation[0m [90m0.001s[0m
[32m  + [0m[32mTopP validation[0m [90m0.001s[0m
[32m  + [0m[32mMimeType validation[0m [90m0.001s[0m
[32mgemini4s.model.GeminiServiceDefaultsSpec:[0m
[32m  + [0m[32mGenerateContentRequest defaults[0m [90m0.001s[0m
[32m  + [0m[32mEmbedContentRequest defaults[0m [90m0.0s[0m
[32m  + [0m[32mCreateCachedContentRequest defaults[0m [90m0.0s[0m
[32m  + [0m[32mContent defaults[0m [90m0.001s[0m
[32m  + [0m[32mGenerationConfig defaults[0m [90m0.0s[0m
[32m  + [0m[32mTool defaults[0m [90m0.0s[0m
[32m  + [0m[32mToolConfig defaults[0m [90m0.0s[0m
[32m  + [0m[32mFunctionCallingConfig defaults[0m [90m0.0s[0m
[32m  + [0m[32mFunctionDeclaration defaults[0m [90m0.0s[0m
[32m  + [0m[32mSchema defaults[0m [90m0.001s[0m
[32mgemini4s.GeminiServiceSpec:[0m
[32m  + [0m[32mgenerateContent should call client with correct request and endpoint[0m [90m0.002s[0m
[32m  + [0m[32mgenerateContentStream should call client with correct request and endpoint[0m [90m0.001s[0m
[32m  + [0m[32mcountTokens should call client with correct request[0m [90m0.001s[0m
[32m  + [0m[32membedContent should call client with correct request[0m [90m0.001s[0m
[32m  + [0m[32mbatchEmbedContents should call client with correct request[0m [90m0.0s[0m
[32m  + [0m[32mcreateCachedContent should call client with correct request[0m [90m0.001s[0m
[error] Failed: Total 121, Failed 3, Errors 0, Passed 118
[error] Failed tests:
[error] 	gemini4s.GeminiConstantsSpec
[error] (Test / test) sbt.TestsFailedException: Tests unsuccessful
[error] Total time: 1 s, completed 2 Dec 2025, 09:45:56
